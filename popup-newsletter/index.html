
<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Landing Page com Popup</title>
<style>
  body { font-family: Arial, sans-serif; margin:0; padding:0; height:2000px; /* só para demo scroll */ }

  /* Fundo modal */
  #modal-bg {
    display:none;
    position:fixed;
    top:0; left:0;
    width:100%; height:100%;
    background:rgba(0,0,0,0.5);
    z-index:9998;
    opacity:0;
    transition: opacity 0.4s;
  }

  /* Modal */
  #modal {
    display:none;
    position:fixed;
    top:50%; left:50%;
    transform:translate(-50%, -50%);
    background:#fff;
    padding:20px;
    border-radius:12px;
    box-shadow:0 6px 20px rgba(0,0,0,.3);
    z-index:9999;
    width:90%;
    max-width:400px;
    opacity:0;
    transition: opacity 0.4s;
  }

  #modal iframe {
    width:100%;
    height:400px;
    border:0;
    border-radius:8px;
  }

  #closeBtn {
    position:absolute;
    top:8px; right:12px;
    cursor:pointer;
    font-size:20px;
    font-weight:bold;
  }
</style>
</head>
<body>

<h1>Bem-vindo à landing page!</h1>
<p>Desce a página e vais ver o popup aparecer na metade.</p>

<!-- Modal -->
<div id="modal-bg"></div>
<div id="modal">
  <span id="closeBtn">&times;</span>
  <iframe src="https://script.google.com/macros/s/1-NVyrvL73MJkKlJymNQ3qR0fdw1fKKQr8jD1WWvFKEk/exec"></iframe>

</div>

<script>
  const modalBg = document.getElementById('modal-bg');
  const modal = document.getElementById('modal');
  const closeBtn = document.getElementById('closeBtn');

  function showModal() {
    modalBg.style.display = 'block';
    modal.style.display = 'block';
    setTimeout(() => { modalBg.style.opacity = '1'; modal.style.opacity = '1'; }, 10);
  }

  function closeModal() {
    modalBg.style.opacity = '0';
    modal.style.opacity = '0';
    setTimeout(() => { modalBg.style.display = 'none'; modal.style.display = 'none'; }, 400);
  }

  closeBtn.onclick = closeModal;
  modalBg.onclick = closeModal;

  // Trigger: metade da página
  window.addEventListener('scroll', function() {
    const scrollPosition = window.scrollY + window.innerHeight;
    const triggerPosition = document.body.scrollHeight / 2;

    if(scrollPosition > triggerPosition) {
      showModal();
      window.removeEventListener('scroll', arguments.callee); // dispara só uma vez
    }
  });
</script>

</body>
</html>
